<h1>Questions#show</h1>
<p>Find me in app/views/questions/show.html.erb</p>

<%= link_to user_path(@question.user.id) do %>
<%= attachment_image_tag @question.user, :image, :fill, 60, 60, fallback: "no_image.jpg" %>
<% end %>
<%= @question.user.name %>
<%= @question.title %>
<%= @question.body %>

<!--解決ボタン-->
<% if @question.is_solved == false %>
<% if current_user.id == @question.user_id %>
  <%= form_with(model: @question, local: true ) do |f| %>
    <%= f.check_box :is_solved, autofocus: true %>
    <%= f.submit "解決済み" %>
  <% end %>
<% end %>
<% end %>

<% if current_user.id == @question.user_id %>
  <%= link_to_unless @question.best_answer_id, 'questionのedi', edit_question_path(@question) %>
<% end %>

<!--コメント作成フォーム-->
<% if @question.is_solved == false %>
  <%= form_with(model:[@question, @answer], local: true ) do |f| %>
  <%= f.text_area :body, rows:'5', cols:'80' %>
  <%= f.submit "送信" %>
  <% end %>
<% end %>

<!--コメント一覧-->
<% @question.answers.each do |answer| %>
  <tr>
    <td>
      <%= attachment_image_tag answer.user, :image, :fill, 60, 60, fallback: "no_image.jpg" %><br>
      <%= answer.user.name %>
    </td>
    <td>
      <div class="card-body  <%= "best-answer" if @question.best_answer_id == answer.id %>">
      <%= answer.body %>
      </div>
    </td>

    <td>
        <% if answer.user == current_user %>
  <div class="comment-delete">
    <%= link_to_unless @question.best_answer_id, 'answer削除', edit_question_path(@question) %>
  </div>
        <% end %>
    </td>
  </tr>

  <!--ベストアンサーボタン-->
<div class="ba-child text-center">
          <%= form_with(model: @question, local: true, data: {confirm: "#{answer.user.name}さんの回答をベストアンサーにします。この修正は変更できませんが、よろしいですか？"}) do |f| %>
            <%= f.hidden_field :best_answer_id, value: @answer %>
              <%= f.submit 'BA', disabled: @question.best_answer_id.present? %>
          <% end %>
</div>

<% end %>


<% if current_user.id == @question.user_id %>
  <%= link_to_unless @question.best_answer_id, 'question削除', question_path(@question), method: :delete %>
<% end %>

