<%= render 'layouts/header', user: @user %>
<div class="container pt-3">
  <div class="row mx-auto mt-1">
    <div class="col-5 mx-auto pb-4 pt-4 text-center bg-white" style="width:1%;">
      <head>
       <meta charset="UTF-8">
       <title>30minTimer</title>
       <link rel="stylesheet" href="main.css">
       </head>
       <body>
       <div id="timer">
       <h4>【30分タイマー】</h4>
       <p class="h1">
       <span id="min">30</span> 分
       <span id="sec">0</span> 秒
       </p>
       <p>
       <input type="button" id="start" value="START" class="btn btn-primary btn-lg">
       <input type="button" id="stop" value="STOP" disabled   class="btn btn-danger btn-lg">
       <input type="button" id="reset" value="RESET" class="btn btn-success btn-lg">
       </p>
       </div>
       </body>
      </html>
      <%= link_to "学習を開始する", pomo_timer_long_time_path, class: "btn btn-success btn-sm" %>
    </div>
  </div>
</div>

<script>

  window.onload = function(){
}
// varで変数宣言
// 30分を秒にした
 var time = 1800;
 var counter;
// getElementByIdは、任意のHTMLタグで指定したIDにマッチするドキュメント要素を取得するメソッド
 var min = document.getElementById("min");
 var sec = document.getElementById("sec");
 var start = document.getElementById("start");
 var stop = document.getElementById("stop");
 var reset = document.getElementById("reset");

 start.onclick = function() {
toggle();
counter = setInterval( count, 1000 );
}
// setInterval→一定時間ごとに処理を繰り返す
// 1000ミリ秒ごとにカウントする

stop.onclick = function() {
toggle();
clearInterval( counter );
}
// clearIntervaでカウントを

reset.onclick = function() {
time = 1800;
sec.innerHTML = time % 60;
min.innerHTML = Math.floor( time / 60 );
}

function toggle() {
 if( start.disabled ) {
  start.disabled = false;
  stop.disabled = true;
} else {
  start.disabled = true
  stop.disabled = false;
  }
}

 function count() {
 if( time === 0 ) {
 sec.innerHTML = 0;
 min.innerHTML = 0;
 toggle();
 alert("30分経ちました。学習を開始しましょう。");
 clearInterval( counter );
 } else {
 time -= 1;
 sec.innerHTML = time % 60;
 min.innerHTML = Math.floor( time / 60 );
 }
 }

</script>